ABOUT
Common spatial pattern (CSP) is a mathematical procedure used in signal processing for separating a multivariate signal into additive subcomponents which have maximum differences in variance between two windows.[1]
FULL TEXT
Common spatial pattern (CSP) is a mathematical procedure used in signal processing for separating a multivariate signal into additive subcomponents which have maximum differences in variance between two windows.[1]


Let 





X


1




{\displaystyle \mathbf {X} _{1}}

 of size 



(
n
,

t

1


)


{\displaystyle (n,t_{1})}

 and 





X


2




{\displaystyle \mathbf {X} _{2}}

 of size 



(
n
,

t

2


)


{\displaystyle (n,t_{2})}

 be two windows of a multivariate signal, where 



n


{\displaystyle n}

 is the number of signals and 




t

1




{\displaystyle t_{1}}

 and 




t

2




{\displaystyle t_{2}}

 are the respective number of samples.
The CSP algorithm determines the component 





w


T




{\displaystyle \mathbf {w} ^{\text{T}}}

 such that the ratio of variance (or second-order moment) is maximized between the two windows:
The solution is given by computing the two covariance matrices:
Then, the simultaneous diagonalization of those two matrices (also called generalized eigenvalue decomposition) is realized. We find the matrix of eigenvectors 




P

=


[





p


1




⋯




p


n





]




{\displaystyle \mathbf {P} ={\begin{bmatrix}\mathbf {p} _{1}&\cdots &\mathbf {p} _{n}\end{bmatrix}}}

 and the diagonal matrix 




D



{\displaystyle \mathbf {D} }

 of eigenvalues 



{

λ

1


,
⋯
,

λ

n


}


{\displaystyle \{\lambda _{1},\cdots ,\lambda _{n}\}}

 sorted by decreasing order such that:
and
with 





I


n




{\displaystyle \mathbf {I} _{n}}

 the identity matrix.
This is equivalent to the eigendecomposition of 





R


2


−
1




R


1




{\displaystyle \mathbf {R} _{2}^{-1}\mathbf {R} _{1}}

:
The eigenvectors composing 




P



{\displaystyle \mathbf {P} }

 are components with variance ratio between the two windows equal to their corresponding eigenvalue:
The vectorial subspace 




E

i




{\displaystyle E_{i}}

 generated by the 



i


{\displaystyle i}

 first eigenvectors 





[





p


1




⋯




p


i





]




{\displaystyle {\begin{bmatrix}\mathbf {p} _{1}&\cdots &\mathbf {p} _{i}\end{bmatrix}}}

 will be the subspace maximizing the variance ratio of all components belonging to it:
On the same way, the vectorial subpsace 




F

j




{\displaystyle F_{j}}

 generated by the 



j


{\displaystyle j}

 last eigenvectors 





[





p


n
−
j
+
1




⋯




p


n





]




{\displaystyle {\begin{bmatrix}\mathbf {p} _{n-j+1}&\cdots &\mathbf {p} _{n}\end{bmatrix}}}

 will be the subspace minimizing the variance ratio of all components belonging to it:
CSP can be applied after a mean subtraction (a.k.a. "mean centering") on signals in order to realize a variance ratio optimization. Otherwize CSP optimizes the ratio of second-order moment.
This method can be applied to several multivariate signal but it seems that most works on it concern electroencephalographic signals.
Particularly, the method is mostly used on brain–computer interface in order to retrieve the component signal which best transduce the cerebral activity for a specific task (e.g. hand movement).[4]
It can also be used to separate artifacts from electroencephalographics signals.[2]