{
    "about": "Pseudo-spectral methods,[1] also known as discrete variable representation (DVR) methods, are a class of numerical methods used in applied mathematics and scientific computing for the solution of partial differential equations. They are closely related to spectral methods, but complement the basis by an additional pseudo-spectral basis, which allows to represent functions on a quadrature grid. This simplifies the evaluation of certain operators, and can considerably speed up the calculation when using fast algorithms such as the fast Fourier transform.", 
    "classification": "Numerical Analysis", 
    "wikipedia_url": "http://en.wikipedia.org/wiki/Pseudo-spectral_method\n", 
    "full_text": "Pseudo-spectral methods,[1] also known as discrete variable representation (DVR) methods, are a class of numerical methods used in applied mathematics and scientific computing for the solution of partial differential equations. They are closely related to spectral methods, but complement the basis by an additional pseudo-spectral basis, which allows to represent functions on a quadrature grid. This simplifies the evaluation of certain operators, and can considerably speed up the calculation when using fast algorithms such as the fast Fourier transform.\n\n\nTake the initial-value problem\nwith periodic conditions \n\n\n\n\u03c8\n(\nx\n+\n2\n\u03c0\n,\nt\n)\n=\n\u03c8\n(\nx\n,\nt\n)\n\n\n{\\displaystyle \\psi (x+2\\pi ,t)=\\psi (x,t)}\n\n. This specific example is the Schr\u00f6dinger equation for a particle in a potential \n\n\n\nV\n(\nx\n)\n\n\n{\\displaystyle V(x)}\n\n, but the structure is more general. In many practical partial differential equations, one has a term that involves derivatives (such as a kinetic energy contribution), and a multiplication with a function (for example, a potential).\nIn the spectral method, the solution \n\n\n\n\u03c8\n\n\n{\\displaystyle \\psi }\n\n is expanded in a suitable set of basis functions, for example plane waves,\nInsertion and equating identical coefficients yields a set of ordinary differential equations for the coefficients,\nwhere the elements \n\n\n\n\nV\n\nn\nk\n\n\n\n\n{\\displaystyle V_{nk}}\n\n are calculated through the explicit Fourier-transform\nThe solution would then be obtained by truncating the expansion to \n\n\n\nN\n\n\n{\\displaystyle N}\n\n basis functions, and finding a solution for the \n\n\n\n\nc\n\nn\n\n\n(\nt\n)\n\n\n{\\displaystyle c_{n}(t)}\n\n. In general, this is done by numerical methods, such as Runge\u2013Kutta methods. For the numerical solutions, the right-hand side of the ordinary differential equation has to be evaluated repeatedly at different time steps. At this point, the spectral method has a major problem with the potential term \n\n\n\nV\n(\nx\n)\n\n\n{\\displaystyle V(x)}\n\n.\nIn the spectral representation, the multiplication with the function \n\n\n\nV\n(\nx\n)\n\n\n{\\displaystyle V(x)}\n\n transforms into a vector-matrix multiplication, which scales as \n\n\n\n\nN\n\n2\n\n\n\n\n{\\displaystyle N^{2}}\n\n. Also, the matrix elements \n\n\n\n\nV\n\nn\nk\n\n\n\n\n{\\displaystyle V_{nk}}\n\n need to be evaluated explicitly before the differential equation for the coefficients can be solved, which requires an additional step.\nIn the pseudo-spectral method, this term is evaluated differently. Given the coefficients \n\n\n\n\nc\n\nn\n\n\n(\nt\n)\n\n\n{\\displaystyle c_{n}(t)}\n\n, an inverse discrete Fourier transform yields the value of the function \n\n\n\n\u03c8\n\n\n{\\displaystyle \\psi }\n\n at discrete grid points \n\n\n\n\nx\n\nj\n\n\n=\n2\n\u03c0\nj\n\n/\n\nN\n\n\n{\\displaystyle x_{j}=2\\pi j/N}\n\n. At these grid points, the function is then multiplied, \n\n\n\n\n\u03c8\n\u2032\n\n(\n\nx\n\ni\n\n\n,\nt\n)\n=\nV\n(\n\nx\n\ni\n\n\n)\n\u03c8\n(\n\nx\n\ni\n\n\n,\nt\n)\n\n\n{\\displaystyle \\psi '(x_{i},t)=V(x_{i})\\psi (x_{i},t)}\n\n, and the result Fourier-transformed back. This yields a new set of coefficients \n\n\n\n\nc\n\nn\n\n\u2032\n\n(\nt\n)\n\n\n{\\displaystyle c'_{n}(t)}\n\n that are used instead of the matrix product \n\n\n\n\n\u2211\n\nk\n\n\n\nV\n\nn\nk\n\n\n\nc\n\nk\n\n\n(\nt\n)\n\n\n{\\displaystyle \\sum _{k}V_{nk}c_{k}(t)}\n\n.\nIt can be shown that both methods have similar accuracy. However, the pseudo-spectral method allows the use of a fast Fourier transform, which scales as \n\n\n\nO\n(\nN\nln\n\u2061\nN\n)\n\n\n{\\displaystyle O(N\\ln N)}\n\n, and is therefore significantly more efficient than the matrix multiplication. Also, the function \n\n\n\nV\n(\nx\n)\n\n\n{\\displaystyle V(x)}\n\n can be used directly without evaluating any additional integrals.\nIn a more abstract way, the pseudo-spectral method deals with the multiplication of two functions \n\n\n\nV\n(\nx\n)\n\n\n{\\displaystyle V(x)}\n\n and \n\n\n\nf\n(\nx\n)\n\n\n{\\displaystyle f(x)}\n\n as part of a partial differential equation. To simplify the notation, the time-dependence is dropped. Conceptually, it consists of three steps:\n\nThe functions \n\n\n\nf\n,\n\n\n\nf\n~\n\n\n\n\n\n{\\displaystyle f,{\\tilde {f}}}\n\n can be expanded in a finite basis \n\n\n\n{\n\n\u03d5\n\nn\n\n\n\n}\n\nn\n=\n0\n,\n\u2026\n,\nN\n\n\n\n\n{\\displaystyle \\{\\phi _{n}\\}_{n=0,\\ldots ,N}}\n\n as\nFor simplicity, let the basis be orthogonal and normalized, \n\n\n\n\u27e8\n\n\u03d5\n\nn\n\n\n,\n\n\u03d5\n\nm\n\n\n\u27e9\n=\n\n\u03b4\n\nn\nm\n\n\n\n\n{\\displaystyle \\langle \\phi _{n},\\phi _{m}\\rangle =\\delta _{nm}}\n\n using the inner product \n\n\n\n\u27e8\nf\n,\ng\n\u27e9\n=\n\n\u222b\n\na\n\n\nb\n\n\nf\n(\nx\n)\n\n\n\ng\n(\nx\n)\n\n\u00af\n\n\nd\nx\n\n\n{\\displaystyle \\langle f,g\\rangle =\\int _{a}^{b}f(x){\\overline {g(x)}}dx}\n\n with appropriate boundaries \n\n\n\na\n,\nb\n\n\n{\\displaystyle a,b}\n\n. The coefficients are then obtained by\nA bit of calculus yields then\nwith \n\n\n\n\nV\n\nn\nm\n\n\n=\n\u27e8\nV\n\n\u03d5\n\nm\n\n\n,\n\n\u03d5\n\nn\n\n\n\u27e9\n\n\n{\\displaystyle V_{nm}=\\langle V\\phi _{m},\\phi _{n}\\rangle }\n\n. This forms the basis of the spectral method. To distinguish the basis of the \n\n\n\n\n\u03d5\n\nn\n\n\n\n\n{\\displaystyle \\phi _{n}}\n\n from the quadrature basis, the expansion is sometimes called Finite Basis Representation (FBR).\n\nFor a given basis \n\n\n\n{\n\n\u03d5\n\nn\n\n\n}\n\n\n{\\displaystyle \\{\\phi _{n}\\}}\n\n and number of \n\n\n\nN\n+\n1\n\n\n{\\displaystyle N+1}\n\n basis functions, one can try to find a quadrature, i.e., a set of \n\n\n\nN\n+\n1\n\n\n{\\displaystyle N+1}\n\n points and weights such that\nSpecial examples are the Gaussian quadrature for polynomials and the Discrete Fourier Transform for plane waves. It should be stressed that the grid points and weights, \n\n\n\n\nx\n\ni\n\n\n,\n\nw\n\ni\n\n\n\n\n{\\displaystyle x_{i},w_{i}}\n\n are a function of the basis and the number \n\n\n\nN\n\n\n{\\displaystyle N}\n\n.\nThe quadrature allows an alternative numerical representation of the function \n\n\n\nf\n(\nx\n)\n,\n\n\n\nf\n~\n\n\n\n(\nx\n)\n\n\n{\\displaystyle f(x),{\\tilde {f}}(x)}\n\n through their value at the grid points. This representation is sometimes denoted Discrete Variable Representation (DVR), and is completely equivalent to the expansion in the basis.\n\nThe multiplication with the function \n\n\n\nV\n(\nx\n)\n\n\n{\\displaystyle V(x)}\n\n is then done at each grid point,\nThis generally introduces an additional approximation. To see this, we can calculate one of the coefficients \n\n\n\n\n\n\n\nc\n~\n\n\n\n\nn\n\n\n\n\n{\\displaystyle {\\tilde {c}}_{n}}\n\n:\nHowever, using the spectral method, the same coefficient would be \n\n\n\n\n\n\n\nc\n~\n\n\n\n\nn\n\n\n=\n\u27e8\nV\nf\n,\n\n\u03d5\n\nn\n\n\n\u27e9\n\n\n{\\displaystyle {\\tilde {c}}_{n}=\\langle Vf,\\phi _{n}\\rangle }\n\n. The pseudo-spectral method thus introduces the additional approximation\nIf the product \n\n\n\nV\nf\n\n\n{\\displaystyle Vf}\n\n can be represented with the given finite set of basis functions, the above equation is exact due to the chosen quadrature.\nIf periodic boundary conditions with period \n\n\n\n[\n0\n,\nL\n]\n\n\n{\\displaystyle [0,L]}\n\n are imposed on the system, the basis functions can be generated by plane waves,\nwith \n\n\n\n\nk\n\nn\n\n\n=\n(\n\u2212\n1\n\n)\n\nn\n\n\n\u2308\nn\n\n/\n\n2\n\u2309\n2\n\u03c0\n\n/\n\nL\n\n\n{\\displaystyle k_{n}=(-1)^{n}\\lceil n/2\\rceil 2\\pi /L}\n\n, where \n\n\n\n\u2308\n\u22c5\n\u2309\n\n\n{\\displaystyle \\lceil \\cdot \\rceil }\n\n is the ceiling function.\nThe quadrature for a cut-off at \n\n\n\n\nn\n\nmax\n\n\n=\nN\n\n\n{\\displaystyle n_{\\text{max}}=N}\n\n is given by the discrete Fourier transformation. The grid points are equally spaced, \n\n\n\n\nx\n\ni\n\n\n=\ni\n\u0394\nx\n\n\n{\\displaystyle x_{i}=i\\Delta x}\n\n with spacing \n\n\n\n\u0394\nx\n=\nL\n\n/\n\n(\nN\n+\n1\n)\n\n\n{\\displaystyle \\Delta x=L/(N+1)}\n\n, and the constant weights are \n\n\n\n\nw\n\ni\n\n\n=\n\u0394\nx\n\n\n{\\displaystyle w_{i}=\\Delta x}\n\n.\nFor the discussion of the error, note that the product of two plane waves is again a plane wave, \n\n\n\n\n\u03d5\n\na\n\n\n+\n\n\u03d5\n\nb\n\n\n=\n\n\u03d5\n\nc\n\n\n\n\n{\\displaystyle \\phi _{a}+\\phi _{b}=\\phi _{c}}\n\n with \n\n\n\nc\n\u2264\na\n+\nb\n\n\n{\\displaystyle c\\leq a+b}\n\n. Thus, qualitatively, if the functions \n\n\n\nf\n(\nx\n)\n,\nV\n(\nx\n)\n\n\n{\\displaystyle f(x),V(x)}\n\n can be represented sufficiently accurately with \n\n\n\n\nN\n\nf\n\n\n,\n\nN\n\nV\n\n\n\n\n{\\displaystyle N_{f},N_{V}}\n\n basis functions, the pseudo-spectral method gives accurate results if \n\n\n\n\nN\n\nf\n\n\n+\n\nN\n\nV\n\n\n\n\n{\\displaystyle N_{f}+N_{V}}\n\n basis functions are used.\nAn expansion in plane waves often has a poor quality and needs many basis functions to converge. However, the transformation between the basis expansion and the grid representation can be done using a Fast Fourier transform, which scales favorably as \n\n\n\nN\nln\n\u2061\nN\n\n\n{\\displaystyle N\\ln N}\n\n. As a consequence, plane waves are one of the most common expansion that is encountered with pseudo-spectral methods.\nAnother common expansion is into classical polynomials. Here, the Gaussian quadrature is used, which states that one can always find weights \n\n\n\n\nw\n\ni\n\n\n\n\n{\\displaystyle w_{i}}\n\n and points \n\n\n\n\nx\n\ni\n\n\n\n\n{\\displaystyle x_{i}}\n\n such that\nholds for any polynomial \n\n\n\np\n(\nx\n)\n\n\n{\\displaystyle p(x)}\n\n of degree \n\n\n\n2\nN\n+\n1\n\n\n{\\displaystyle 2N+1}\n\n or less. Typically, the weight function \n\n\n\nw\n(\nx\n)\n\n\n{\\displaystyle w(x)}\n\n and ranges \n\n\n\na\n,\nb\n\n\n{\\displaystyle a,b}\n\n are chosen for a specific problem, and leads to one of the different forms of the quadrature. To apply this to the pseudo-spectral method, we choose basis functions \n\n\n\n\n\u03d5\n\nn\n\n\n(\nx\n)\n=\n\n\nw\n(\nx\n)\n\n\n\nP\n\nn\n\n\n(\nx\n)\n\n\n{\\displaystyle \\phi _{n}(x)={\\sqrt {w(x)}}P_{n}(x)}\n\n, with \n\n\n\n\nP\n\nn\n\n\n\n\n{\\displaystyle P_{n}}\n\n being a polynomial of degree \n\n\n\nn\n\n\n{\\displaystyle n}\n\n with the property\nUnder these conditions, the \n\n\n\n\n\u03d5\n\nn\n\n\n\n\n{\\displaystyle \\phi _{n}}\n\n form an orthonormal basis with respect to the scalar product \n\n\n\n\u27e8\nf\n,\ng\n\u27e9\n=\n\n\u222b\n\na\n\n\nb\n\n\nf\n(\nx\n)\n\n\n\ng\n(\nx\n)\n\n\u00af\n\n\nd\nx\n\n\n{\\displaystyle \\langle f,g\\rangle =\\int _{a}^{b}f(x){\\overline {g(x)}}dx}\n\n. This basis, together with the quadrature points can then be used for the pseudo-spectral method.\nFor the discussion of the error, note that if \n\n\n\nf\n\n\n{\\displaystyle f}\n\n is well represented by \n\n\n\n\nN\n\nf\n\n\n\n\n{\\displaystyle N_{f}}\n\n basis functions and \n\n\n\nV\n\n\n{\\displaystyle V}\n\n is well represented by a polynomial of degree \n\n\n\n\nN\n\nV\n\n\n\n\n{\\displaystyle N_{V}}\n\n, their product can be expanded in the first \n\n\n\n\nN\n\nf\n\n\n+\n\nN\n\nV\n\n\n\n\n{\\displaystyle N_{f}+N_{V}}\n\n basis functions, and the pseudo-spectral method will give accurate results for that many basis functions.\nSuch polynomials occur naturally in several standard problems. For example, the quantum harmonic oscillator is ideally expanded in Hermite polynomials, and Jacobi-polynomials can be used to define the associated Legendre functions typically appearing in rotational problems.", 
    "name": "Pseudo Spectral Method"
}