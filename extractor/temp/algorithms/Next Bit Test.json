{
    "about": "In cryptography and the theory of computation, the next-bit test[1] is a test against pseudo-random number generators. We say that a sequence of bits passes the next bit test for at any position \n\n\n\ni\n\n\n{\\displaystyle i}\n\n in the sequence, if any attacker who knows the \n\n\n\ni\n\n\n{\\displaystyle i}\n\n first bits (but not the seed) cannot predict the \n\n\n\n(\ni\n+\n1\n)\n\n\n{\\displaystyle (i+1)}\n\nst with reasonable computational power.", 
    "classification": "Pseudorandom Number Generators", 
    "wikipedia_url": "http://en.wikipedia.org/wiki/Next-bit_test\n", 
    "full_text": "In cryptography and the theory of computation, the next-bit test[1] is a test against pseudo-random number generators. We say that a sequence of bits passes the next bit test for at any position \n\n\n\ni\n\n\n{\\displaystyle i}\n\n in the sequence, if any attacker who knows the \n\n\n\ni\n\n\n{\\displaystyle i}\n\n first bits (but not the seed) cannot predict the \n\n\n\n(\ni\n+\n1\n)\n\n\n{\\displaystyle (i+1)}\n\nst with reasonable computational power.\n\n\nLet \n\n\n\nP\n\n\n{\\displaystyle P}\n\n be a polynomial, and \n\n\n\nS\n=\n{\n\nS\n\nk\n\n\n}\n\n\n{\\displaystyle S=\\{S_{k}\\}}\n\n be a collection of sets such that \n\n\n\n\nS\n\nk\n\n\n\n\n{\\displaystyle S_{k}}\n\n contains \n\n\n\nP\n(\nk\n)\n\n\n{\\displaystyle P(k)}\n\n-bit long sequences. Moreover, let \n\n\n\n\n\u03bc\n\nk\n\n\n\n\n{\\displaystyle \\mu _{k}}\n\n be the probability distribution of the strings in \n\n\n\n\nS\n\nk\n\n\n\n\n{\\displaystyle S_{k}}\n\n.\nWe now define the next-bit test in two different ways.\nA predicting collection[2] \n\n\n\nC\n=\n{\n\nC\n\nk\n\n\ni\n\n\n}\n\n\n{\\displaystyle C=\\{C_{k}^{i}\\}}\n\n is a collection of boolean circuits, such that each circuit \n\n\n\n\nC\n\nk\n\n\ni\n\n\n\n\n{\\displaystyle C_{k}^{i}}\n\n has less than \n\n\n\n\nP\n\nC\n\n\n(\nk\n)\n\n\n{\\displaystyle P_{C}(k)}\n\n gates and exactly \n\n\n\ni\n\n\n{\\displaystyle i}\n\n inputs. Let \n\n\n\n\np\n\nk\n,\ni\n\n\nC\n\n\n\n\n{\\displaystyle p_{k,i}^{C}}\n\n be the probability that, on input the \n\n\n\ni\n\n\n{\\displaystyle i}\n\n first bits of \n\n\n\ns\n\n\n{\\displaystyle s}\n\n, a string randomly selected in \n\n\n\n\nS\n\nk\n\n\n\n\n{\\displaystyle S_{k}}\n\n with probability \n\n\n\n\n\u03bc\n\nk\n\n\n(\ns\n)\n\n\n{\\displaystyle \\mu _{k}(s)}\n\n, the circuit correctly predicts \n\n\n\n\ns\n\ni\n+\n1\n\n\n\n\n{\\displaystyle s_{i+1}}\n\n, i.e.\u00a0:\n\n\n\n\n\np\n\nk\n,\ni\n\n\nC\n\n\n=\n\n\nP\n\n\n\n[\n\nC\n\nk\n\n\n(\n\ns\n\n1\n\n\n\u2026\n\ns\n\ni\n\n\n)\n=\n\ns\n\ni\n+\n1\n\n\n|\n\ns\n\u2208\n\nS\n\nk\n\n\n\n\u00a0with probability\u00a0\n\n\n\u03bc\n\nk\n\n\n(\ns\n)\n]\n\n\n{\\displaystyle p_{k,i}^{C}={\\mathcal {P}}\\left[C_{k}(s_{1}\\ldots s_{i})=s_{i+1}\\right|s\\in S_{k}{\\text{ with probability }}\\mu _{k}(s)]}\n\n\nNow, we say that \n\n\n\n{\n\nS\n\nk\n\n\n\n}\n\nk\n\n\n\n\n{\\displaystyle \\{S_{k}\\}_{k}}\n\n passes the next-bit test if for any predicting collection \n\n\n\nC\n\n\n{\\displaystyle C}\n\n, any polynomial \n\n\n\nQ\n\n\n{\\displaystyle Q}\n\n\u00a0:\n\n\n\n\n\np\n\nk\n,\ni\n\n\nC\n\n\n<\n\n\n1\n2\n\n\n+\n\n\n1\n\nQ\n(\nk\n)\n\n\n\n\n\n{\\displaystyle p_{k,i}^{C}<{\\frac {1}{2}}+{\\frac {1}{Q(k)}}}\n\n\nWe can also define the next-bit test in terms of probabilistic Turing machines, although this definition is somewhat stronger (see Adleman's theorem). Let \n\n\n\n\n\nM\n\n\n\n\n{\\displaystyle {\\mathcal {M}}}\n\n be a probabilistic Turing machine, working in polynomial time. Let \n\n\n\n\np\n\nk\n,\ni\n\n\n\nM\n\n\n\n\n\n{\\displaystyle p_{k,i}^{\\mathcal {M}}}\n\n be the probability that \n\n\n\n\n\nM\n\n\n\n\n{\\displaystyle {\\mathcal {M}}}\n\n predicts the \n\n\n\n(\ni\n+\n1\n)\n\n\n{\\displaystyle (i+1)}\n\nst bit correctly, i.e.\n\n\n\n\n\np\n\nk\n,\ni\n\n\n\nM\n\n\n\n=\n\n\nP\n\n\n[\nM\n(\n\ns\n\n1\n\n\n\u2026\n\ns\n\ni\n\n\n)\n=\n\ns\n\ni\n+\n1\n\n\n\n|\n\ns\n\u2208\n\nS\n\nk\n\n\n\n\u00a0with probability\u00a0\n\n\n\u03bc\n\nk\n\n\n(\ns\n)\n]\n\n\n{\\displaystyle p_{k,i}^{\\mathcal {M}}={\\mathcal {P}}[M(s_{1}\\ldots s_{i})=s_{i+1}|s\\in S_{k}{\\text{ with probability }}\\mu _{k}(s)]}\n\n\nWe say that collection \n\n\n\nS\n=\n{\n\nS\n\nk\n\n\n}\n\n\n{\\displaystyle S=\\{S_{k}\\}}\n\n passes the next-bit test if for all polynomial \n\n\n\nQ\n\n\n{\\displaystyle Q}\n\n, for all but finitely many \n\n\n\nk\n\n\n{\\displaystyle k}\n\n, for all \n\n\n\n0\n<\ni\n<\nk\n\n\n{\\displaystyle 0<i<k}\n\n:\n\n\n\n\n\np\n\nk\n,\ni\n\n\n\nM\n\n\n\n<\n\n\n1\n2\n\n\n+\n\n\n1\n\nQ\n(\nk\n)\n\n\n\n\n\n{\\displaystyle p_{k,i}^{\\mathcal {M}}<{\\frac {1}{2}}+{\\frac {1}{Q(k)}}}\n\n\nThe next-bit test is a particular case of Yao's test for random sequences, and passing it is therefore a necessary condition for passing Yao's test. However, it has also been shown a sufficient condition by Yao.[1]\nWe prove it now in the case of probabilistic Turing machine, since Adleman has already done the work of replacing randomization with non-uniformity in his theorem. The case of boolean circuits cannot be derived from this case (since it involves deciding potentially undecidable problems), but the proof of Adleman's theorem can be easily adapted to the case of non-uniform boolean circuits families.\nLet \n\n\n\n\n\nM\n\n\n\n\n{\\displaystyle {\\mathcal {M}}}\n\n a distringuer for the probabilistic version of Yao's test, i.e. a probabilistic Turing machine, running in polynomial time, such that there is a polynomial \n\n\n\nQ\n\n\n{\\displaystyle Q}\n\n such that for infinitely many \n\n\n\nk\n\n\n{\\displaystyle k}\n\n\nLet \n\n\n\n\nR\n\nk\n,\ni\n\n\n=\n{\n\ns\n\n1\n\n\n\u2026\n\ns\n\ni\n\n\n\nu\n\ni\n+\n1\n\n\n\u2026\n\nu\n\nP\n(\nk\n)\n\n\n\n|\n\ns\n\u2208\n\nS\n\nk\n\n\n,\nu\n\u2208\n{\n0\n,\n1\n\n}\n\nP\n(\nk\n)\n\n\n}\n\n\n{\\displaystyle R_{k,i}=\\{s_{1}\\ldots s_{i}u_{i+1}\\ldots u_{P(k)}|s\\in S_{k},u\\in \\{0,1\\}^{P(k)}\\}}\n\n. We have\u00a0: \n\n\n\n\nR\n\nk\n,\n0\n\n\n=\n{\n0\n,\n1\n\n}\n\nP\n(\nk\n)\n\n\n\n\n{\\displaystyle R_{k,0}=\\{0,1\\}^{P(k)}}\n\n and \n\n\n\n\nR\n\nk\n,\nP\n(\nk\n)\n\n\n=\n\nS\n\nk\n\n\n\n\n{\\displaystyle R_{k,P(k)}=S_{k}}\n\n. Then, we notice that \n\n\n\n\n\u2211\n\ni\n=\n0\n\n\nP\n(\nk\n)\n\n\n\n|\n\n\np\n\nk\n,\n\nR\n\nk\n,\ni\n+\n1\n\n\n\n\n\nM\n\n\n\n\u2212\n\np\n\nk\n,\n\nR\n\nk\n,\ni\n\n\n\n\n\nM\n\n\n\n\n|\n\n\u2265\n\n|\n\n\np\n\nk\n,\n\nR\n\nk\n,\nP\n(\nk\n)\n\n\n\n\n\nM\n\n\n\n\u2212\n\np\n\nk\n,\n\nR\n\nk\n,\n0\n\n\n\n\n\nM\n\n\n\n\n|\n\n=\n\n|\n\n\np\n\nk\n,\nS\n\n\n\nM\n\n\n\n\u2212\n\np\n\nk\n,\nU\n\n\n\nM\n\n\n\n\n|\n\n\u2265\n\n\n1\n\nQ\n(\nk\n)\n\n\n\n\n\n{\\displaystyle \\sum _{i=0}^{P(k)}|p_{k,R_{k,i+1}}^{\\mathcal {M}}-p_{k,R_{k,i}}^{\\mathcal {M}}|\\geq |p_{k,R_{k,P(k)}}^{\\mathcal {M}}-p_{k,R_{k,0}}^{\\mathcal {M}}|=|p_{k,S}^{\\mathcal {M}}-p_{k,U}^{\\mathcal {M}}|\\geq {\\frac {1}{Q(k)}}}\n\n. Therefore, at least one of the \n\n\n\n\n|\n\n\np\n\nk\n,\n\nR\n\nk\n,\ni\n+\n1\n\n\n\n\n\nM\n\n\n\n\u2212\n\np\n\nk\n,\n\nR\n\nk\n,\ni\n\n\n\n\n\nM\n\n\n\n\n|\n\n\n\n{\\displaystyle |p_{k,R_{k,i+1}}^{\\mathcal {M}}-p_{k,R_{k,i}}^{\\mathcal {M}}|}\n\n should be no smaller than \n\n\n\n\n\n1\n\nQ\n(\nk\n)\nP\n(\nk\n)\n\n\n\n\n\n{\\displaystyle {\\frac {1}{Q(k)P(k)}}}\n\n.\nNext, we consider probability distributions \n\n\n\n\n\u03bc\n\nk\n,\ni\n\n\n\n\n{\\displaystyle \\mu _{k,i}}\n\n and \n\n\n\n\n\n\n\u03bc\n\nk\n,\ni\n\n\n\u00af\n\n\n\n\n{\\displaystyle {\\overline {\\mu _{k,i}}}}\n\n on \n\n\n\n\nR\n\nk\n,\ni\n\n\n\n\n{\\displaystyle R_{k,i}}\n\n. Distribution \n\n\n\n\n\u03bc\n\nk\n,\ni\n\n\n\n\n{\\displaystyle \\mu _{k,i}}\n\n is the probability distribution of choosing the \n\n\n\ni\n\n\n{\\displaystyle i}\n\n first bits in \n\n\n\n\nS\n\nk\n\n\n\n\n{\\displaystyle S_{k}}\n\n with probability given by \n\n\n\n\n\u03bc\n\nk\n\n\n\n\n{\\displaystyle \\mu _{k}}\n\n, and the \n\n\n\nP\n(\nk\n)\n\u2212\ni\n\n\n{\\displaystyle P(k)-i}\n\n remaining bits uniformly at random. We have thus\u00a0:\n\n\n\n\n\n\u03bc\n\nk\n,\ni\n\n\n(\n\nw\n\n1\n\n\n\u2026\n\nw\n\nP\n(\nk\n)\n\n\n)\n=\n\n(\n\n\u2211\n\ns\n\u2208\n\nS\n\nk\n\n\n,\n\ns\n\n1\n\n\n\u2026\n\ns\n\ni\n\n\n=\n\nw\n\n1\n\n\n\u2026\n\nw\n\ni\n\n\n\n\n\n\u03bc\n\nk\n\n\n(\ns\n)\n)\n\n\n\n(\n\n\n1\n2\n\n\n)\n\n\nP\n(\nk\n)\n\u2212\ni\n\n\n\n\n{\\displaystyle \\mu _{k,i}(w_{1}\\ldots w_{P(k)})=\\left(\\sum _{s\\in S_{k},s_{1}\\ldots s_{i}=w_{1}\\ldots w_{i}}\\mu _{k}(s)\\right)\\left({\\frac {1}{2}}\\right)^{P(k)-i}}\n\n\n\n\n\n\n\n\n\n\u03bc\n\nk\n,\ni\n\n\n\u00af\n\n\n(\n\nw\n\n1\n\n\n\u2026\n\nw\n\nP\n(\nk\n)\n\n\n)\n=\n\n(\n\n\u2211\n\ns\n\u2208\n\nS\n\nk\n\n\n,\n\ns\n\n1\n\n\n\u2026\n\ns\n\ni\n\u2212\n1\n\n\n(\n1\n\u2212\n\ns\n\ni\n\n\n)\n=\n\nw\n\n1\n\n\n\u2026\n\nw\n\ni\n\n\n\n\n\n\u03bc\n\nk\n\n\n(\ns\n)\n)\n\n\n\n(\n\n\n1\n2\n\n\n)\n\n\nP\n(\nk\n)\n\u2212\ni\n\n\n\n\n{\\displaystyle {\\overline {\\mu _{k,i}}}(w_{1}\\ldots w_{P(k)})=\\left(\\sum _{s\\in S_{k},s_{1}\\ldots s_{i-1}(1-s_{i})=w_{1}\\ldots w_{i}}\\mu _{k}(s)\\right)\\left({\\frac {1}{2}}\\right)^{P(k)-i}}\n\n\nWe thus have \n\n\n\n\n\u03bc\n\nk\n,\ni\n\n\n=\n\n\n1\n2\n\n\n(\n\n\u03bc\n\nk\n,\ni\n+\n1\n\n\n+\n\n\n\n\u03bc\n\nk\n,\ni\n+\n1\n\n\n\u00af\n\n\n)\n\n\n{\\displaystyle \\mu _{k,i}={\\frac {1}{2}}(\\mu _{k,i+1}+{\\overline {\\mu _{k,i+1}}})}\n\n (a simple calculus trick shows this), thus distributions \n\n\n\n\n\u03bc\n\nk\n,\ni\n+\n1\n\n\n\n\n{\\displaystyle \\mu _{k,i+1}}\n\n and \n\n\n\n\n\n\n\u03bc\n\nk\n,\ni\n+\n1\n\n\n\u00af\n\n\n\n\n{\\displaystyle {\\overline {\\mu _{k,i+1}}}}\n\n can be distinguished by \n\n\n\n\n\nM\n\n\n\n\n{\\displaystyle {\\mathcal {M}}}\n\n. Without loss of generality, we can assume that \n\n\n\n\np\n\n\n\u03bc\n\nk\n,\ni\n+\n1\n\n\n\n\n\nM\n\n\n\n\u2212\n\np\n\n\n\n\u03bc\n\nk\n,\ni\n+\n1\n\n\n\u00af\n\n\n\n\nM\n\n\n\n\u2265\n\n\n1\n2\n\n\n+\n\n\n1\n\nR\n(\nk\n)\n\n\n\n\n\n{\\displaystyle p_{\\mu _{k,i+1}}^{\\mathcal {M}}-p_{\\overline {\\mu _{k,i+1}}}^{\\mathcal {M}}\\geq {\\frac {1}{2}}+{\\frac {1}{R(k)}}}\n\n, with \n\n\n\nR\n\n\n{\\displaystyle R}\n\n a polynomial.\nThis gives us a possible construction of a Turing machine solving the next-bit test\u00a0: upon receiving the \n\n\n\ni\n\n\n{\\displaystyle i}\n\n first bits of a sequence, \n\n\n\n\n\nN\n\n\n\n\n{\\displaystyle {\\mathcal {N}}}\n\n pads this input with a guess of bit \n\n\n\nl\n\n\n{\\displaystyle l}\n\n and then \n\n\n\nP\n(\nk\n)\n\u2212\ni\n\u2212\n1\n\n\n{\\displaystyle P(k)-i-1}\n\n random bits, chosen with uniform probability. Then it runs \n\n\n\n\n\nM\n\n\n\n\n{\\displaystyle {\\mathcal {M}}}\n\n, and outputs \n\n\n\nl\n\n\n{\\displaystyle l}\n\n if the result is \n\n\n\n1\n\n\n{\\displaystyle 1}\n\n, and \n\n\n\n1\n\u2212\nl\n\n\n{\\displaystyle 1-l}\n\n else.", 
    "name": "Next Bit Test"
}