{
    "about": "WPGMA (Weighted Pair Group Method with Arithmetic Mean) is a simple agglomerative (bottom-up) hierarchical clustering method, generally attributed to Sokal and Michener.[1]", 
    "name": "Wpgma", 
    "classification": "Bioinformatics Algorithms", 
    "full_text": "WPGMA (Weighted Pair Group Method with Arithmetic Mean) is a simple agglomerative (bottom-up) hierarchical clustering method, generally attributed to Sokal and Michener.[1]\nThe WPGMA method is similar to its unweighted variant, the UPGMA method.\n\n\nThe WPGMA algorithm constructs a rooted tree (dendrogram) that reflects the structure present in a pairwise distance matrix (or a similarity matrix). At each step, the nearest two clusters, say \n\n\n\ni\n\n\n{\\displaystyle i}\n\n and \n\n\n\nj\n\n\n{\\displaystyle j}\n\n, are combined into a higher-level cluster \n\n\n\ni\n\u222a\nj\n\n\n{\\displaystyle i\\cup j}\n\n. Then, its distance to another cluster \n\n\n\nk\n\n\n{\\displaystyle k}\n\n is simply the arithmetic mean of the distances between \n\n\n\nk\n\n\n{\\displaystyle k}\n\n and members of \n\n\n\ni\n\u222a\nj\n\n\n{\\displaystyle i\\cup j}\n\n\u00a0:\n\n\n\n\n\nd\n\n(\ni\n\u222a\nj\n)\n,\nk\n\n\n=\n\n\n\n\nd\n\ni\n,\nk\n\n\n+\n\nd\n\nj\n,\nk\n\n\n\n2\n\n\n\n\n{\\displaystyle d_{(i\\cup j),k}={\\frac {d_{i,k}+d_{j,k}}{2}}}\n\n\nThe WPGMA algorithm produces rooted dendrograms and requires a constant-rate assumption: it produces an ultrametric tree in which the distances from the root to every branch tip are equal. This ultrametricity assumption is called the molecular clock when the tips involve DNA, RNA and protein data.\nLet us assume that we have five elements \n\n\n\n(\na\n,\nb\n,\nc\n,\nd\n,\ne\n)\n\n\n{\\displaystyle (a,b,c,d,e)}\n\n and the following matrix \n\n\n\n\nD\n\n1\n\n\n\n\n{\\displaystyle D_{1}}\n\n of pairwise distances between them\u00a0:\nIn this example, \n\n\n\n\nD\n\n1\n\n\n(\na\n,\nb\n)\n=\n17\n\n\n{\\displaystyle D_{1}(a,b)=17}\n\n is the smallest value of \n\n\n\n\nD\n\n1\n\n\n\n\n{\\displaystyle D_{1}}\n\n, so we join elements \n\n\n\na\n\n\n{\\displaystyle a}\n\n and \n\n\n\nb\n\n\n{\\displaystyle b}\n\n.\nLet \n\n\n\nu\n\n\n{\\displaystyle u}\n\n denote the node to which \n\n\n\na\n\n\n{\\displaystyle a}\n\n and \n\n\n\nb\n\n\n{\\displaystyle b}\n\n are now connected. Setting \n\n\n\n\u03b4\n(\na\n,\nu\n)\n=\n\u03b4\n(\nb\n,\nu\n)\n=\n\nD\n\n1\n\n\n(\na\n,\nb\n)\n\n/\n\n2\n\n\n{\\displaystyle \\delta (a,u)=\\delta (b,u)=D_{1}(a,b)/2}\n\n ensures that elements \n\n\n\na\n\n\n{\\displaystyle a}\n\n and \n\n\n\nb\n\n\n{\\displaystyle b}\n\n are equidistant from \n\n\n\nu\n\n\n{\\displaystyle u}\n\n. This corresponds to the expectation of the ultrametricity hypothesis. The branches joining \n\n\n\na\n\n\n{\\displaystyle a}\n\n and \n\n\n\nb\n\n\n{\\displaystyle b}\n\n to \n\n\n\nu\n\n\n{\\displaystyle u}\n\n then have lengths \n\n\n\n\u03b4\n(\na\n,\nu\n)\n=\n\u03b4\n(\nb\n,\nu\n)\n=\n17\n\n/\n\n2\n=\n8.5\n\n\n{\\displaystyle \\delta (a,u)=\\delta (b,u)=17/2=8.5}\n\n (see the final dendrogram)\nWe then proceed to update the initial distance matrix \n\n\n\n\nD\n\n1\n\n\n\n\n{\\displaystyle D_{1}}\n\n into a new distance matrix \n\n\n\n\nD\n\n2\n\n\n\n\n{\\displaystyle D_{2}}\n\n (see below), reduced in size by one row and one column because of the clustering of \n\n\n\na\n\n\n{\\displaystyle a}\n\n with \n\n\n\nb\n\n\n{\\displaystyle b}\n\n. Bold values in \n\n\n\n\nD\n\n2\n\n\n\n\n{\\displaystyle D_{2}}\n\n correspond to the new distances, calculated by averaging distances between the first cluster \n\n\n\n(\na\n,\nb\n)\n\n\n{\\displaystyle (a,b)}\n\n and each of the remaining elements:\n\n\n\n\n\nD\n\n2\n\n\n(\n(\na\n,\nb\n)\n,\nc\n)\n=\n(\n\nD\n\n1\n\n\n(\na\n,\nc\n)\n+\n\nD\n\n1\n\n\n(\nb\n,\nc\n)\n)\n\n/\n\n2\n=\n(\n21\n+\n30\n)\n\n/\n\n2\n=\n25.5\n\n\n{\\displaystyle D_{2}((a,b),c)=(D_{1}(a,c)+D_{1}(b,c))/2=(21+30)/2=25.5}\n\n\n\n\n\n\n\nD\n\n2\n\n\n(\n(\na\n,\nb\n)\n,\nd\n)\n=\n(\n\nD\n\n1\n\n\n(\na\n,\nd\n)\n+\n\nD\n\n1\n\n\n(\nb\n,\nd\n)\n)\n\n/\n\n2\n=\n(\n31\n+\n34\n)\n\n/\n\n2\n=\n32.5\n\n\n{\\displaystyle D_{2}((a,b),d)=(D_{1}(a,d)+D_{1}(b,d))/2=(31+34)/2=32.5}\n\n\n\n\n\n\n\nD\n\n2\n\n\n(\n(\na\n,\nb\n)\n,\ne\n)\n=\n(\n\nD\n\n1\n\n\n(\na\n,\ne\n)\n+\n\nD\n\n1\n\n\n(\nb\n,\ne\n)\n)\n\n/\n\n2\n=\n(\n23\n+\n21\n)\n\n/\n\n2\n=\n22\n\n\n{\\displaystyle D_{2}((a,b),e)=(D_{1}(a,e)+D_{1}(b,e))/2=(23+21)/2=22}\n\n\nItalicized values in \n\n\n\n\nD\n\n2\n\n\n\n\n{\\displaystyle D_{2}}\n\n are not affected by the matrix update as they correspond to distances between elements not involved in the first cluster.\nWe now reiterate the three previous steps, starting from the new distance matrix \n\n\n\n\nD\n\n2\n\n\n\n\n{\\displaystyle D_{2}}\n\n\u00a0:\nHere, \n\n\n\n\nD\n\n2\n\n\n(\n(\na\n,\nb\n)\n,\ne\n)\n=\n22\n\n\n{\\displaystyle D_{2}((a,b),e)=22}\n\n is the smallest value of \n\n\n\n\nD\n\n2\n\n\n\n\n{\\displaystyle D_{2}}\n\n, so we join cluster \n\n\n\n(\na\n,\nb\n)\n\n\n{\\displaystyle (a,b)}\n\n and element \n\n\n\ne\n\n\n{\\displaystyle e}\n\n.\nLet \n\n\n\nv\n\n\n{\\displaystyle v}\n\n denote the node to which \n\n\n\n(\na\n,\nb\n)\n\n\n{\\displaystyle (a,b)}\n\n and \n\n\n\ne\n\n\n{\\displaystyle e}\n\n are now connected. Because of the ultrametricity constraint, the branches joining \n\n\n\na\n\n\n{\\displaystyle a}\n\n or \n\n\n\nb\n\n\n{\\displaystyle b}\n\n to \n\n\n\nv\n\n\n{\\displaystyle v}\n\n, and \n\n\n\ne\n\n\n{\\displaystyle e}\n\n to \n\n\n\nv\n\n\n{\\displaystyle v}\n\n are equal and have the following length: \n\n\n\n\u03b4\n(\na\n,\nv\n)\n=\n\u03b4\n(\nb\n,\nv\n)\n=\n\u03b4\n(\ne\n,\nv\n)\n=\n22\n\n/\n\n2\n=\n11\n\n\n{\\displaystyle \\delta (a,v)=\\delta (b,v)=\\delta (e,v)=22/2=11}\n\n\nWe deduce the missing branch length: \n\n\n\n\u03b4\n(\nu\n,\nv\n)\n=\n\u03b4\n(\ne\n,\nv\n)\n\u2212\n\u03b4\n(\na\n,\nu\n)\n=\n\u03b4\n(\ne\n,\nv\n)\n\u2212\n\u03b4\n(\nb\n,\nu\n)\n=\n11\n\u2212\n8.5\n=\n2.5\n\n\n{\\displaystyle \\delta (u,v)=\\delta (e,v)-\\delta (a,u)=\\delta (e,v)-\\delta (b,u)=11-8.5=2.5}\n\n (see the final dendrogram)\nWe then proceed to update the \n\n\n\n\nD\n\n2\n\n\n\n\n{\\displaystyle D_{2}}\n\n matrix into a new distance matrix \n\n\n\n\nD\n\n3\n\n\n\n\n{\\displaystyle D_{3}}\n\n (see below), reduced in size by one row and one column because of the clustering of \n\n\n\n(\na\n,\nb\n)\n\n\n{\\displaystyle (a,b)}\n\n with \n\n\n\ne\n\n\n{\\displaystyle e}\n\n\u00a0: \n\n\n\n\nD\n\n3\n\n\n(\n(\n(\na\n,\nb\n)\n,\ne\n)\n,\nc\n)\n=\n(\n\nD\n\n2\n\n\n(\n(\na\n,\nb\n)\n,\nc\n)\n+\n\nD\n\n2\n\n\n(\ne\n,\nc\n)\n)\n\n/\n\n2\n=\n(\n25.5\n+\n39\n)\n\n/\n\n2\n=\n32.25\n\n\n{\\displaystyle D_{3}(((a,b),e),c)=(D_{2}((a,b),c)+D_{2}(e,c))/2=(25.5+39)/2=32.25}\n\n\nOf note, this average calculation of the new distance does not account for the larger size of the \n\n\n\n(\na\n,\nb\n)\n\n\n{\\displaystyle (a,b)}\n\n cluster (two elements) with respect to \n\n\n\ne\n\n\n{\\displaystyle e}\n\n (one element). Similarly:\n\n\n\n\n\nD\n\n3\n\n\n(\n(\n(\na\n,\nb\n)\n,\ne\n)\n,\nd\n)\n=\n(\n\nD\n\n2\n\n\n(\n(\na\n,\nb\n)\n,\nd\n)\n+\n\nD\n\n2\n\n\n(\ne\n,\nd\n)\n)\n\n/\n\n2\n=\n(\n32.5\n+\n43\n)\n\n/\n\n2\n=\n37.75\n\n\n{\\displaystyle D_{3}(((a,b),e),d)=(D_{2}((a,b),d)+D_{2}(e,d))/2=(32.5+43)/2=37.75}\n\n\nThe averaging procedure therefore gives differential weight to the initial distances of matrix \n\n\n\n\nD\n\n1\n\n\n\n\n{\\displaystyle D_{1}}\n\n. This is the reason why the method is weighted, not with respect to the mathematical procedure but with respect to the initial distances.\nWe again reiterate the three previous steps, starting from the updated distance matrix \n\n\n\n\nD\n\n3\n\n\n\n\n{\\displaystyle D_{3}}\n\n.\nHere, \n\n\n\n\nD\n\n3\n\n\n(\nc\n,\nd\n)\n=\n28\n\n\n{\\displaystyle D_{3}(c,d)=28}\n\n is the smallest value of \n\n\n\n\nD\n\n3\n\n\n\n\n{\\displaystyle D_{3}}\n\n, so we join elements \n\n\n\nc\n\n\n{\\displaystyle c}\n\n and \n\n\n\nd\n\n\n{\\displaystyle d}\n\n.\nLet \n\n\n\nw\n\n\n{\\displaystyle w}\n\n denote the node to which \n\n\n\nc\n\n\n{\\displaystyle c}\n\n and \n\n\n\nd\n\n\n{\\displaystyle d}\n\n are now connected. The branches joining \n\n\n\nc\n\n\n{\\displaystyle c}\n\n and \n\n\n\nd\n\n\n{\\displaystyle d}\n\n to \n\n\n\nw\n\n\n{\\displaystyle w}\n\n then have lengths \n\n\n\n\u03b4\n(\nc\n,\nw\n)\n=\n\u03b4\n(\nd\n,\nw\n)\n=\n28\n\n/\n\n2\n=\n14\n\n\n{\\displaystyle \\delta (c,w)=\\delta (d,w)=28/2=14}\n\n (see the final dendrogram)\nThere is a single entry to update: \n\n\n\n\nD\n\n4\n\n\n(\n(\nc\n,\nd\n)\n,\n(\n(\na\n,\nb\n)\n,\ne\n)\n)\n=\n(\n\nD\n\n3\n\n\n(\nc\n,\n(\n(\na\n,\nb\n)\n,\ne\n)\n)\n+\n\nD\n\n3\n\n\n(\nd\n,\n(\n(\na\n,\nb\n)\n,\ne\n)\n)\n)\n\n/\n\n2\n=\n(\n32.25\n+\n37.75\n)\n\n/\n\n2\n=\n35\n\n\n{\\displaystyle D_{4}((c,d),((a,b),e))=(D_{3}(c,((a,b),e))+D_{3}(d,((a,b),e)))/2=(32.25+37.75)/2=35}\n\n\nThe final \n\n\n\n\nD\n\n4\n\n\n\n\n{\\displaystyle D_{4}}\n\n matrix is:\nSo we join clusters \n\n\n\n(\n(\na\n,\nb\n)\n,\ne\n)\n\n\n{\\displaystyle ((a,b),e)}\n\n and \n\n\n\n(\nc\n,\nd\n)\n\n\n{\\displaystyle (c,d)}\n\n.\nLet \n\n\n\nr\n\n\n{\\displaystyle r}\n\n denote the (root) node to which \n\n\n\n(\n(\na\n,\nb\n)\n,\ne\n)\n\n\n{\\displaystyle ((a,b),e)}\n\n and \n\n\n\n(\nc\n,\nd\n)\n\n\n{\\displaystyle (c,d)}\n\n are now connected. The branches joining \n\n\n\n(\n(\na\n,\nb\n)\n,\ne\n)\n\n\n{\\displaystyle ((a,b),e)}\n\n and \n\n\n\n(\nc\n,\nd\n)\n\n\n{\\displaystyle (c,d)}\n\n to \n\n\n\nr\n\n\n{\\displaystyle r}\n\n then have lengths:\n\n\n\n\n\u03b4\n(\n(\n(\na\n,\nb\n)\n,\ne\n)\n,\nr\n)\n=\n\u03b4\n(\n(\nc\n,\nd\n)\n,\nr\n)\n=\n35\n\n/\n\n2\n=\n17.5\n\n\n{\\displaystyle \\delta (((a,b),e),r)=\\delta ((c,d),r)=35/2=17.5}\n\n\nWe deduce the two remaining branch lengths:\n\n\n\n\n\u03b4\n(\nv\n,\nr\n)\n=\n\u03b4\n(\n(\n(\na\n,\nb\n)\n,\ne\n)\n,\nr\n)\n\u2212\n\u03b4\n(\ne\n,\nv\n)\n=\n17.5\n\u2212\n11\n=\n6.5\n\n\n{\\displaystyle \\delta (v,r)=\\delta (((a,b),e),r)-\\delta (e,v)=17.5-11=6.5}\n\n\n\n\n\n\n\u03b4\n(\nw\n,\nr\n)\n=\n\u03b4\n(\n(\nc\n,\nd\n)\n,\nr\n)\n\u2212\n\u03b4\n(\nc\n,\nw\n)\n=\n17.5\n\u2212\n14\n=\n3.5\n\n\n{\\displaystyle \\delta (w,r)=\\delta ((c,d),r)-\\delta (c,w)=17.5-14=3.5}\n\n\n\nThe dendrogram is now complete. It is ultrametric because all tips (\n\n\n\na\n\n\n{\\displaystyle a}\n\n to \n\n\n\ne\n\n\n{\\displaystyle e}\n\n) are equidistant from \n\n\n\nr\n\n\n{\\displaystyle r}\n\n\u00a0:\n\n\n\n\n\u03b4\n(\na\n,\nr\n)\n=\n\u03b4\n(\nb\n,\nr\n)\n=\n\u03b4\n(\ne\n,\nr\n)\n=\n\u03b4\n(\nc\n,\nr\n)\n=\n\u03b4\n(\nd\n,\nr\n)\n=\n17.5\n\n\n{\\displaystyle \\delta (a,r)=\\delta (b,r)=\\delta (e,r)=\\delta (c,r)=\\delta (d,r)=17.5}\n\n\nThe dendrogram is therefore rooted by \n\n\n\nr\n\n\n{\\displaystyle r}\n\n, its deepest node.", 
    "dbpedia_url": "http://dbpedia.org/resource/WPGMA", 
    "wikipedia_url": "http://en.wikipedia.org/wiki/WPGMA\n"
}